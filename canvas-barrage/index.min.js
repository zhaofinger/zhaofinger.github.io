"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),Barrage=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20;_classCallCheck(this,t),this.ctx=e.getContext("2d"),this.ctx.font="30px \u5fae\u8f6f\u96c5\u9ed1",this.width=e.width,this.height=e.height,this.msgs=new Array(i),this.msgStackLength=i,this.intervalId="",this.quality=n}return _createClass(t,[{key:"_getLimitRandom",value:function(t,e){return Math.floor(Math.random()*(e-t)+t)}},{key:"_getRandomColor",value:function(){var t=["00","33","66","99","cc","ff"],e=t.length;return"#"+t[this._getLimitRandom(0,e)]+t[this._getLimitRandom(0,e)]+t[this._getLimitRandom(0,e)]}},{key:"_draw",value:function(){var t=this;this.intervalId||(this.intervalId=setInterval(function(){t.ctx.clearRect(0,0,t.width,t.height),t.ctx.save(),t.msgs.map(function(e){if(e)if(e.left||"number"==typeof e.left)if(e.left<0-e.width)e=null;else{e.left=parseInt(e.left-e.speed),t.ctx.fillStyle=e.color,t.ctx.fillText(e.text,e.left,e.top);var i=t.ctx.measureText(e.text);e.width=i.width,t.ctx.restore}else e.left=t.width,e.top=e.top||t._getLimitRandom(30,t.height-30),e.speed=e.speed||t._getLimitRandom(2,4),e.color=e.color||t._getRandomColor()})},this.quality))}},{key:"pushMessage",value:function(t){for(var e=0;e<this.msgStackLength;e++)if(!this.msgs[e]){this.msgs[e]=t;break}this._draw()}},{key:"clear",value:function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=""),this.ctx.clearRect(0,0,this.width,this.height),this.msgs.map(function(t){return null})}}]),t}();